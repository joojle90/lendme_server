"use strict";
/**
 * Created by Joojle on 10/04/18.
 */
var express = require("express");
var q_refgroup_1 = require("./q_refgroup");
var router = express.Router();
var db = require('../../database/db.service');
var authentication = require('../../utils/authentication');
// get all campgrounds
router.get('/refgroup', function (req, res) {
    db.getConnection(function (err, connection) {
        if (err) {
            res.status(500).send({ message: err });
        }
        else {
            var params_1 = req.query;
            var record = void 0, query_line_1 = "";
            record = "" + q_refgroup_1.REF_GROUP_SELECTIVE;
            if (Object.keys(params_1).length > 0) {
                Object.keys(params_1).forEach(function (key, index) {
                    if (key === "moduleId") {
                        var criteria = params_1.moduleId === "" ? "" : " AND module_id = " + ("'" + params_1.moduleId + "'");
                        query_line_1 += criteria;
                    }
                });
            }
            record += query_line_1;
            console.log("RECORD", record);
            connection.query(record, function (err, results) {
                connection.release();
                if (err) {
                    res.status(500).send({ message: err });
                }
                else {
                    res.send(results);
                }
            });
        }
    });
});
module.exports = router;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlcy9yZWZncm91cC9yZWZncm91cC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7QUFFSCxpQ0FBbUM7QUFDbkMsMkNBQW1EO0FBRW5ELElBQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUVoQyxJQUFNLEVBQUUsR0FBRyxPQUFPLENBQUMsMkJBQTJCLENBQUMsQ0FBQztBQUNoRCxJQUFNLGNBQWMsR0FBRyxPQUFPLENBQUMsNEJBQTRCLENBQUMsQ0FBQztBQUU3RCxzQkFBc0I7QUFDdEIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsVUFBQyxHQUFRLEVBQUUsR0FBUTtJQUMxQyxFQUFFLENBQUMsYUFBYSxDQUFDLFVBQUMsR0FBUSxFQUFFLFVBQWU7UUFDMUMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztZQUNULEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUMsT0FBTyxFQUFFLEdBQUcsRUFBQyxDQUFDLENBQUM7UUFDdEMsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ1AsSUFBTSxRQUFNLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQztZQUV6QixJQUFJLE1BQU0sU0FBQSxFQUFFLFlBQVUsR0FBRyxFQUFFLENBQUM7WUFFNUIsTUFBTSxHQUFHLEtBQUksZ0NBQXNCLENBQUM7WUFFcEMsRUFBRSxDQUFBLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFNLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDbkMsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQyxHQUFHLEVBQUUsS0FBSztvQkFDdEMsRUFBRSxDQUFDLENBQUMsR0FBRyxLQUFLLFVBQVUsQ0FBQyxDQUFDLENBQUM7d0JBQ3hCLElBQU0sUUFBUSxHQUFHLFFBQU0sQ0FBQyxRQUFRLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLG1CQUFtQixJQUFHLE1BQUssUUFBTSxDQUFDLFFBQVEsTUFBSSxDQUFBLENBQUM7d0JBQzlGLFlBQVUsSUFBSSxRQUFRLENBQUM7b0JBQ3hCLENBQUM7Z0JBQ0YsQ0FBQyxDQUFDLENBQUM7WUFDSixDQUFDO1lBRUQsTUFBTSxJQUFLLFlBQVUsQ0FBQztZQUN0QixPQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUU5QixVQUFVLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxVQUFDLEdBQVEsRUFBRSxPQUFZO2dCQUMvQyxVQUFVLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBRXJCLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7b0JBQ1QsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBQyxPQUFPLEVBQUUsR0FBRyxFQUFDLENBQUMsQ0FBQztnQkFDdEMsQ0FBQztnQkFBQyxJQUFJLENBQUMsQ0FBQztvQkFDUCxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUNuQixDQUFDO1lBQ0YsQ0FBQyxDQUFDLENBQUM7UUFDSixDQUFDO0lBQ0YsQ0FBQyxDQUFDLENBQUM7QUFDSixDQUFDLENBQUMsQ0FBQztBQUVILGlCQUFTLE1BQU0sQ0FBQyIsImZpbGUiOiJyb3V0ZXMvcmVmZ3JvdXAvcmVmZ3JvdXAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkgSm9vamxlIG9uIDEwLzA0LzE4LlxuICovXG5cbmltcG9ydCAqIGFzIGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgeyBSRUZfR1JPVVBfU0VMRUNUSVZFIH0gZnJvbSBcIi4vcV9yZWZncm91cFwiO1xuXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuXG5jb25zdCBkYiA9IHJlcXVpcmUoJy4uLy4uL2RhdGFiYXNlL2RiLnNlcnZpY2UnKTtcbmNvbnN0IGF1dGhlbnRpY2F0aW9uID0gcmVxdWlyZSgnLi4vLi4vdXRpbHMvYXV0aGVudGljYXRpb24nKTtcblxuLy8gZ2V0IGFsbCBjYW1wZ3JvdW5kc1xucm91dGVyLmdldCgnL3JlZmdyb3VwJywgKHJlcTogYW55LCByZXM6IGFueSkgPT4ge1xuXHRkYi5nZXRDb25uZWN0aW9uKChlcnI6IGFueSwgY29ubmVjdGlvbjogYW55KSA9PiB7XG5cdFx0aWYgKGVycikge1xuXHRcdFx0cmVzLnN0YXR1cyg1MDApLnNlbmQoe21lc3NhZ2U6IGVycn0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBwYXJhbXMgPSByZXEucXVlcnk7XG5cblx0XHRcdGxldCByZWNvcmQsIHF1ZXJ5X2xpbmUgPSBcIlwiO1xuXG5cdFx0XHRyZWNvcmQgPSBgJHsgUkVGX0dST1VQX1NFTEVDVElWRSB9YDtcblxuXHRcdFx0aWYoT2JqZWN0LmtleXMocGFyYW1zKS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdE9iamVjdC5rZXlzKHBhcmFtcykuZm9yRWFjaCgoa2V5LCBpbmRleCkgPT4ge1xuXHRcdFx0XHRcdGlmIChrZXkgPT09IFwibW9kdWxlSWRcIikge1xuXHRcdFx0XHRcdFx0Y29uc3QgY3JpdGVyaWEgPSBwYXJhbXMubW9kdWxlSWQgPT09IFwiXCIgPyBcIlwiIDogXCIgQU5EIG1vZHVsZV9pZCA9IFwiICsgYCckeyBwYXJhbXMubW9kdWxlSWQgfSdgO1xuXHRcdFx0XHRcdFx0cXVlcnlfbGluZSArPSBjcml0ZXJpYTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHRyZWNvcmQgKz0gIHF1ZXJ5X2xpbmU7XG5cdFx0XHRjb25zb2xlLmxvZyhcIlJFQ09SRFwiLCByZWNvcmQpO1xuXG5cdFx0XHRjb25uZWN0aW9uLnF1ZXJ5KHJlY29yZCwgKGVycjogYW55LCByZXN1bHRzOiBhbnkpID0+IHtcblx0XHRcdFx0Y29ubmVjdGlvbi5yZWxlYXNlKCk7XG5cblx0XHRcdFx0aWYgKGVycikge1xuXHRcdFx0XHRcdHJlcy5zdGF0dXMoNTAwKS5zZW5kKHttZXNzYWdlOiBlcnJ9KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXMuc2VuZChyZXN1bHRzKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcbn0pO1xuXG5leHBvcnQgPSByb3V0ZXI7Il19
